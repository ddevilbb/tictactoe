"use strict";var board={init:function(e){this.config={pusher:null,gamePlayChannel:null,gameOverChannel:null,csrf:null,frozen:!1,game:e.hasOwnProperty("game")?e.game:null,user:e.hasOwnProperty("user")?e.user:null,elements:{cell:".tic-cell",game_info:".game-info"}},this.setDefaults(),this.registerEvents(),console.info("initialize - deal")},setDefaults:function(){this.config.csrf=$('meta[name="csrf-token"]').attr("content"),this.config.pusher=new Pusher("5df7c47b97d098f73fd4",{cluster:"ap1",forceTLS:!0}),this.config.gamePlayChannel=this.config.pusher.subscribe("game-channel-"+this.config.game.id+"-1"),this.config.gameOverChannel=this.config.pusher.subscribe("game-over-channel-"+this.config.game.id)},registerEvents:function(){$("body").on("click",this.config.elements.cell,this.setTurn),this.config.gamePlayChannel.bind("App\\Events\\AIPlay",this.showAITurn),this.config.gameOverChannel.bind("App\\Events\\GameOver",this.showGameStatus)},setTurn:function(e){e.preventDefault();var n=$(this),a=n.data("location"),s=board.config.frozen,i=board.config.game;s||null!==i.status||n.hasClass("cell-busy")||(board.config.frozen=!0,board.showTurn(a,board.config.user.sign),$.ajax({url:"/make_turn",method:"post",data:{_token:board.config.csrf,game_id:board.config.game.id,player_id:board.config.user.id,player_sign:board.config.user.sign,location:a}}).done(function(e){board.showTurn(e.location,e.player_sign)}))},showAITurn:function(e){board.config.frozen=!1,board.showTurn(e.location,e.sign)},showTurn:function(e,n){$(board.config.elements.cell).filter(function(n,a){return $(a).data("location")==e}).addClass("tic-turn-"+n+" cell-busy")},showGameStatus:function(e){var n="";switch(board.config.frozen=!0,e.status){case"win":n='<div class="alert alert-success">Вы победили!</div>';break;case"loose":n='<div class="alert alert-danger">Вы проиграли!</div>';break;default:n='<div class="alert alert-secondary">Ничья!</div>'}$(board.config.elements.game_info).html(n)}};
